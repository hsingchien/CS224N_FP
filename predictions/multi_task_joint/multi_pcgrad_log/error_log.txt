train-0:   0%|          | 0/4584 [00:00<?, ?it/s]train-0:   0%|          | 1/4584 [00:00<1:02:15,  1.23it/s]train-0:   0%|          | 2/4584 [00:01<34:35,  2.21it/s]  train-0:   0%|          | 3/4584 [00:01<24:15,  3.15it/s]train-0:   0%|          | 4/4584 [00:01<19:25,  3.93it/s]train-0:   0%|          | 5/4584 [00:01<16:38,  4.58it/s]train-0:   0%|          | 6/4584 [00:01<14:53,  5.12it/s]train-0:   0%|          | 7/4584 [00:01<13:48,  5.52it/s]train-0:   0%|          | 8/4584 [00:01<13:37,  5.60it/s]train-0:   0%|          | 9/4584 [00:02<12:52,  5.92it/s]train-0:   0%|          | 10/4584 [00:02<12:11,  6.25it/s]train-0:   0%|          | 11/4584 [00:02<11:47,  6.47it/s]train-0:   0%|          | 12/4584 [00:02<11:56,  6.38it/s]train-0:   0%|          | 13/4584 [00:02<12:17,  6.20it/s]train-0:   0%|          | 14/4584 [00:02<12:12,  6.24it/s]train-0:   0%|          | 15/4584 [00:03<12:12,  6.23it/s]train-0:   0%|          | 16/4584 [00:03<12:20,  6.17it/s]train-0:   0%|          | 17/4584 [00:03<12:06,  6.28it/s]train-0:   0%|          | 18/4584 [00:03<12:26,  6.11it/s]train-0:   0%|          | 19/4584 [00:03<12:35,  6.04it/s]train-0:   0%|          | 20/4584 [00:03<12:11,  6.24it/s]train-0:   0%|          | 21/4584 [00:03<11:50,  6.43it/s]train-0:   0%|          | 22/4584 [00:04<11:30,  6.61it/s]train-0:   1%|          | 23/4584 [00:04<11:29,  6.61it/s]train-0:   1%|          | 24/4584 [00:04<11:30,  6.60it/s]train-0:   1%|          | 25/4584 [00:04<11:10,  6.80it/s]train-0:   1%|          | 26/4584 [00:04<11:26,  6.64it/s]train-0:   1%|          | 27/4584 [00:04<11:25,  6.65it/s]train-0:   1%|          | 28/4584 [00:05<13:30,  5.62it/s]train-0:   1%|          | 29/4584 [00:05<12:53,  5.89it/s]train-0:   1%|          | 30/4584 [00:05<12:20,  6.15it/s]train-0:   1%|          | 31/4584 [00:05<12:11,  6.22it/s]train-0:   1%|          | 32/4584 [00:05<12:24,  6.12it/s]train-0:   1%|          | 33/4584 [00:05<12:21,  6.14it/s]train-0:   1%|          | 34/4584 [00:06<12:32,  6.05it/s]train-0:   1%|          | 35/4584 [00:06<12:30,  6.06it/s]train-0:   1%|          | 36/4584 [00:06<12:14,  6.19it/s]train-0:   1%|          | 37/4584 [00:06<12:58,  5.84it/s]train-0:   1%|          | 38/4584 [00:06<12:36,  6.01it/s]train-0:   1%|          | 39/4584 [00:06<12:18,  6.16it/s]train-0:   1%|          | 40/4584 [00:07<12:37,  6.00it/s]train-0:   1%|          | 41/4584 [00:07<12:11,  6.21it/s]train-0:   1%|          | 42/4584 [00:07<11:53,  6.37it/s]train-0:   1%|          | 43/4584 [00:07<11:50,  6.39it/s]train-0:   1%|          | 44/4584 [00:07<12:01,  6.30it/s]train-0:   1%|          | 45/4584 [00:07<11:58,  6.32it/s]train-0:   1%|          | 46/4584 [00:08<12:03,  6.28it/s]train-0:   1%|          | 47/4584 [00:08<12:03,  6.27it/s]train-0:   1%|          | 48/4584 [00:08<12:10,  6.21it/s]train-0:   1%|          | 49/4584 [00:08<12:09,  6.22it/s]train-0:   1%|          | 50/4584 [00:08<12:01,  6.28it/s]train-0:   1%|          | 51/4584 [00:08<12:07,  6.23it/s]train-0:   1%|          | 52/4584 [00:08<11:52,  6.36it/s]train-0:   1%|          | 53/4584 [00:09<11:51,  6.37it/s]train-0:   1%|          | 54/4584 [00:09<11:43,  6.44it/s]train-0:   1%|          | 55/4584 [00:09<11:20,  6.65it/s]train-0:   1%|          | 56/4584 [00:09<11:35,  6.51it/s]train-0:   1%|          | 57/4584 [00:09<11:57,  6.31it/s]train-0:   1%|▏         | 58/4584 [00:09<12:19,  6.12it/s]train-0:   1%|▏         | 59/4584 [00:10<12:29,  6.04it/s]train-0:   1%|▏         | 60/4584 [00:10<12:58,  5.81it/s]train-0:   1%|▏         | 61/4584 [00:10<12:50,  5.87it/s]train-0:   1%|▏         | 62/4584 [00:10<12:28,  6.04it/s]train-0:   1%|▏         | 63/4584 [00:10<12:07,  6.21it/s]train-0:   1%|▏         | 64/4584 [00:10<11:57,  6.30it/s]train-0:   1%|▏         | 65/4584 [00:11<11:36,  6.49it/s]train-0:   1%|▏         | 66/4584 [00:11<11:50,  6.36it/s]train-0:   1%|▏         | 67/4584 [00:11<11:56,  6.31it/s]train-0:   1%|▏         | 68/4584 [00:11<11:34,  6.50it/s]train-0:   2%|▏         | 69/4584 [00:11<11:41,  6.44it/s]train-0:   2%|▏         | 70/4584 [00:11<11:19,  6.64it/s]train-0:   2%|▏         | 71/4584 [00:11<11:31,  6.53it/s]train-0:   2%|▏         | 72/4584 [00:12<11:26,  6.57it/s]train-0:   2%|▏         | 73/4584 [00:12<11:43,  6.41it/s]train-0:   2%|▏         | 74/4584 [00:12<11:31,  6.52it/s]train-0:   2%|▏         | 75/4584 [00:12<11:30,  6.53it/s]train-0:   2%|▏         | 76/4584 [00:12<12:00,  6.26it/s]train-0:   2%|▏         | 77/4584 [00:12<11:49,  6.35it/s]train-0:   2%|▏         | 78/4584 [00:13<11:36,  6.47it/s]train-0:   2%|▏         | 79/4584 [00:13<11:54,  6.31it/s]train-0:   2%|▏         | 80/4584 [00:13<12:19,  6.09it/s]train-0:   2%|▏         | 81/4584 [00:13<12:15,  6.12it/s]train-0:   2%|▏         | 82/4584 [00:13<12:05,  6.21it/s]train-0:   2%|▏         | 83/4584 [00:13<12:26,  6.03it/s]train-0:   2%|▏         | 84/4584 [00:14<12:56,  5.79it/s]train-0:   2%|▏         | 85/4584 [00:14<12:46,  5.87it/s]train-0:   2%|▏         | 86/4584 [00:14<12:04,  6.21it/s]train-0:   2%|▏         | 87/4584 [00:14<12:08,  6.17it/s]train-0:   2%|▏         | 88/4584 [00:14<12:13,  6.13it/s]train-0:   2%|▏         | 89/4584 [00:14<12:20,  6.07it/s]train-0:   2%|▏         | 90/4584 [00:15<12:34,  5.95it/s]train-0:   2%|▏         | 91/4584 [00:15<12:17,  6.09it/s]train-0:   2%|▏         | 92/4584 [00:15<12:05,  6.19it/s]train-0:   2%|▏         | 93/4584 [00:15<11:49,  6.33it/s]train-0:   2%|▏         | 94/4584 [00:15<12:28,  6.00it/s]train-0:   2%|▏         | 95/4584 [00:15<12:16,  6.09it/s]train-0:   2%|▏         | 96/4584 [00:16<12:05,  6.18it/s]train-0:   2%|▏         | 97/4584 [00:16<12:17,  6.08it/s]train-0:   2%|▏         | 98/4584 [00:16<12:06,  6.18it/s]train-0:   2%|▏         | 99/4584 [00:16<11:59,  6.23it/s]train-0:   2%|▏         | 100/4584 [00:16<11:45,  6.35it/s]train-0:   2%|▏         | 101/4584 [00:16<11:52,  6.29it/s]train-0:   2%|▏         | 102/4584 [00:16<11:56,  6.25it/s]train-0:   2%|▏         | 103/4584 [00:17<11:58,  6.24it/s]train-0:   2%|▏         | 104/4584 [00:17<12:05,  6.17it/s]train-0:   2%|▏         | 105/4584 [00:17<11:59,  6.22it/s]train-0:   2%|▏         | 106/4584 [00:17<12:03,  6.19it/s]train-0:   2%|▏         | 107/4584 [00:17<14:35,  5.11it/s]train-0:   2%|▏         | 108/4584 [00:18<13:50,  5.39it/s]train-0:   2%|▏         | 109/4584 [00:18<12:52,  5.80it/s]train-0:   2%|▏         | 110/4584 [00:18<12:10,  6.13it/s]train-0:   2%|▏         | 111/4584 [00:18<11:56,  6.24it/s]train-0:   2%|▏         | 112/4584 [00:18<12:16,  6.07it/s]train-0:   2%|▏         | 113/4584 [00:18<12:31,  5.95it/s]train-0:   2%|▏         | 114/4584 [00:19<13:06,  5.68it/s]train-0:   3%|▎         | 115/4584 [00:19<13:13,  5.63it/s]train-0:   3%|▎         | 116/4584 [00:19<15:20,  4.86it/s]train-0:   3%|▎         | 117/4584 [00:19<14:22,  5.18it/s]train-0:   3%|▎         | 118/4584 [00:19<13:53,  5.36it/s]train-0:   3%|▎         | 119/4584 [00:20<13:32,  5.49it/s]train-0:   3%|▎         | 120/4584 [00:20<12:58,  5.73it/s]train-0:   3%|▎         | 121/4584 [00:20<12:46,  5.82it/s]train-0:   3%|▎         | 122/4584 [00:20<12:30,  5.94it/s]train-0:   3%|▎         | 123/4584 [00:20<12:30,  5.95it/s]train-0:   3%|▎         | 124/4584 [00:20<12:23,  6.00it/s]train-0:   3%|▎         | 125/4584 [00:20<12:07,  6.13it/s]train-0:   3%|▎         | 126/4584 [00:21<11:56,  6.22it/s]train-0:   3%|▎         | 127/4584 [00:21<11:58,  6.21it/s]train-0:   3%|▎         | 128/4584 [00:21<11:40,  6.36it/s]train-0:   3%|▎         | 129/4584 [00:21<11:34,  6.41it/s]train-0:   3%|▎         | 130/4584 [00:21<11:35,  6.40it/s]train-0:   3%|▎         | 131/4584 [00:21<11:53,  6.24it/s]train-0:   3%|▎         | 132/4584 [00:22<11:41,  6.34it/s]train-0:   3%|▎         | 133/4584 [00:22<11:52,  6.25it/s]train-0:   3%|▎         | 134/4584 [00:22<11:22,  6.52it/s]train-0:   3%|▎         | 135/4584 [00:22<11:08,  6.66it/s]train-0:   3%|▎         | 136/4584 [00:22<11:21,  6.53it/s]train-0:   3%|▎         | 137/4584 [00:22<11:14,  6.59it/s]train-0:   3%|▎         | 138/4584 [00:22<11:01,  6.72it/s]train-0:   3%|▎         | 139/4584 [00:23<11:08,  6.65it/s]train-0:   3%|▎         | 140/4584 [00:23<11:14,  6.59it/s]train-0:   3%|▎         | 141/4584 [00:23<11:26,  6.47it/s]train-0:   3%|▎         | 142/4584 [00:23<11:30,  6.43it/s]train-0:   3%|▎         | 143/4584 [00:23<11:36,  6.37it/s]train-0:   3%|▎         | 144/4584 [00:23<12:17,  6.02it/s]train-0:   3%|▎         | 145/4584 [00:24<12:33,  5.89it/s]train-0:   3%|▎         | 146/4584 [00:24<12:32,  5.90it/s]train-0:   3%|▎         | 147/4584 [00:24<12:23,  5.96it/s]train-0:   3%|▎         | 148/4584 [00:24<12:18,  6.01it/s]train-0:   3%|▎         | 149/4584 [00:24<12:07,  6.10it/s]train-0:   3%|▎         | 150/4584 [00:24<12:02,  6.14it/s]train-0:   3%|▎         | 151/4584 [00:25<11:52,  6.22it/s]train-0:   3%|▎         | 152/4584 [00:25<12:04,  6.11it/s]train-0:   3%|▎         | 153/4584 [00:25<12:15,  6.03it/s]train-0:   3%|▎         | 154/4584 [00:25<12:34,  5.87it/s]train-0:   3%|▎         | 155/4584 [00:25<12:21,  5.97it/s]train-0:   3%|▎         | 156/4584 [00:25<12:27,  5.92it/s]train-0:   3%|▎         | 157/4584 [00:26<12:41,  5.81it/s]train-0:   3%|▎         | 158/4584 [00:26<12:56,  5.70it/s]train-0:   3%|▎         | 159/4584 [00:26<13:04,  5.64it/s]train-0:   3%|▎         | 160/4584 [00:26<12:24,  5.94it/s]train-0:   4%|▎         | 161/4584 [00:26<12:02,  6.12it/s]train-0:   4%|▎         | 162/4584 [00:26<12:04,  6.10it/s]train-0:   4%|▎         | 163/4584 [00:27<11:54,  6.19it/s]train-0:   4%|▎         | 164/4584 [00:27<11:38,  6.32it/s]train-0:   4%|▎         | 165/4584 [00:27<11:19,  6.51it/s]train-0:   4%|▎         | 166/4584 [00:27<11:34,  6.36it/s]train-0:   4%|▎         | 167/4584 [00:27<11:38,  6.33it/s]train-0:   4%|▎         | 168/4584 [00:27<11:32,  6.38it/s]train-0:   4%|▎         | 169/4584 [00:28<11:41,  6.29it/s]train-0:   4%|▎         | 170/4584 [00:28<11:47,  6.24it/s]train-0:   4%|▎         | 171/4584 [00:28<11:31,  6.39it/s]train-0:   4%|▍         | 172/4584 [00:28<11:17,  6.51it/s]train-0:   4%|▍         | 173/4584 [00:28<11:35,  6.35it/s]train-0:   4%|▍         | 174/4584 [00:28<11:26,  6.42it/s]train-0:   4%|▍         | 175/4584 [00:28<11:07,  6.60it/s]train-0:   4%|▍         | 176/4584 [00:29<11:05,  6.62it/s]train-0:   4%|▍         | 177/4584 [00:29<11:02,  6.65it/s]train-0:   4%|▍         | 178/4584 [00:29<11:11,  6.56it/s]train-0:   4%|▍         | 179/4584 [00:29<11:23,  6.45it/s]train-0:   4%|▍         | 180/4584 [00:29<11:31,  6.37it/s]train-0:   4%|▍         | 181/4584 [00:29<11:03,  6.63it/s]train-0:   4%|▍         | 182/4584 [00:30<11:04,  6.62it/s]train-0:   4%|▍         | 183/4584 [00:30<10:54,  6.73it/s]train-0:   4%|▍         | 184/4584 [00:30<11:09,  6.57it/s]train-0:   4%|▍         | 185/4584 [00:30<10:53,  6.74it/s]train-0:   4%|▍         | 186/4584 [00:30<11:03,  6.63it/s]train-0:   4%|▍         | 187/4584 [00:30<10:43,  6.83it/s]train-0:   4%|▍         | 188/4584 [00:30<11:05,  6.61it/s]train-0:   4%|▍         | 189/4584 [00:31<11:12,  6.53it/s]train-0:   4%|▍         | 190/4584 [00:31<11:06,  6.60it/s]train-0:   4%|▍         | 191/4584 [00:31<11:28,  6.38it/s]train-0:   4%|▍         | 192/4584 [00:31<12:28,  5.86it/s]train-0:   4%|▍         | 193/4584 [00:31<12:46,  5.73it/s]train-0:   4%|▍         | 194/4584 [00:31<12:20,  5.93it/s]train-0:   4%|▍         | 195/4584 [00:32<12:07,  6.04it/s]train-0:   4%|▍         | 196/4584 [00:32<12:27,  5.87it/s]train-0:   4%|▍         | 197/4584 [00:32<13:01,  5.61it/s]train-0:   4%|▍         | 198/4584 [00:32<12:54,  5.66it/s]train-0:   4%|▍         | 199/4584 [00:32<12:53,  5.67it/s]train-0:   4%|▍         | 200/4584 [00:33<12:39,  5.77it/s]train-0:   4%|▍         | 201/4584 [00:33<12:19,  5.92it/s]train-0:   4%|▍         | 202/4584 [00:33<11:39,  6.26it/s]train-0:   4%|▍         | 203/4584 [00:33<11:13,  6.51it/s]train-0:   4%|▍         | 204/4584 [00:33<12:56,  5.64it/s]train-0:   4%|▍         | 205/4584 [00:33<12:11,  5.99it/s]train-0:   4%|▍         | 206/4584 [00:33<11:33,  6.31it/s]train-0:   5%|▍         | 207/4584 [00:34<11:25,  6.39it/s]train-0:   5%|▍         | 208/4584 [00:34<11:24,  6.39it/s]train-0:   5%|▍         | 209/4584 [00:34<11:01,  6.61it/s]train-0:   5%|▍         | 210/4584 [00:34<11:26,  6.37it/s]train-0:   5%|▍         | 211/4584 [00:34<12:02,  6.05it/s]train-0:   5%|▍         | 212/4584 [00:34<11:50,  6.15it/s]train-0:   5%|▍         | 213/4584 [00:35<11:31,  6.32it/s]train-0:   5%|▍         | 214/4584 [00:35<11:33,  6.31it/s]train-0:   5%|▍         | 215/4584 [00:35<11:28,  6.35it/s]train-0:   5%|▍         | 216/4584 [00:35<12:00,  6.06it/s]train-0:   5%|▍         | 217/4584 [00:35<12:13,  5.95it/s]train-0:   5%|▍         | 218/4584 [00:35<12:14,  5.95it/s]train-0:   5%|▍         | 219/4584 [00:36<11:58,  6.08it/s]train-0:   5%|▍         | 220/4584 [00:36<11:40,  6.23it/s]train-0:   5%|▍         | 221/4584 [00:36<11:37,  6.25it/s]train-0:   5%|▍         | 222/4584 [00:36<11:48,  6.16it/s]train-0:   5%|▍         | 223/4584 [00:36<11:38,  6.24it/s]train-0:   5%|▍         | 224/4584 [00:36<11:28,  6.33it/s]train-0:   5%|▍         | 225/4584 [00:36<11:10,  6.50it/s]train-0:   5%|▍         | 226/4584 [00:37<11:00,  6.60it/s]train-0:   5%|▍         | 227/4584 [00:37<11:06,  6.53it/s]train-0:   5%|▍         | 228/4584 [00:37<10:59,  6.60it/s]train-0:   5%|▍         | 229/4584 [00:37<11:07,  6.52it/s]train-0:   5%|▌         | 230/4584 [00:37<11:54,  6.09it/s]train-0:   5%|▌         | 231/4584 [00:37<11:52,  6.11it/s]train-0:   5%|▌         | 232/4584 [00:38<11:45,  6.16it/s]train-0:   5%|▌         | 233/4584 [00:38<11:24,  6.36it/s]train-0:   5%|▌         | 234/4584 [00:38<11:34,  6.26it/s]train-0:   5%|▌         | 235/4584 [00:38<11:36,  6.24it/s]train-0:   5%|▌         | 236/4584 [00:38<11:31,  6.29it/s]train-0:   5%|▌         | 237/4584 [00:38<11:21,  6.37it/s]train-0:   5%|▌         | 238/4584 [00:39<11:21,  6.38it/s]train-0:   5%|▌         | 239/4584 [00:39<11:25,  6.34it/s]train-0:   5%|▌         | 240/4584 [00:39<11:20,  6.38it/s]train-0:   5%|▌         | 241/4584 [00:39<11:25,  6.33it/s]train-0:   5%|▌         | 242/4584 [00:39<12:06,  5.98it/s]train-0:   5%|▌         | 243/4584 [00:39<11:50,  6.11it/s]train-0:   5%|▌         | 244/4584 [00:40<12:04,  5.99it/s]train-0:   5%|▌         | 245/4584 [00:40<12:19,  5.87it/s]train-0:   5%|▌         | 246/4584 [00:40<12:23,  5.84it/s]train-0:   5%|▌         | 247/4584 [00:40<12:48,  5.64it/s]train-0:   5%|▌         | 248/4584 [00:40<12:03,  5.99it/s]train-0:   5%|▌         | 249/4584 [00:40<11:57,  6.04it/s]train-0:   5%|▌         | 250/4584 [00:41<11:59,  6.03it/s]train-0:   5%|▌         | 251/4584 [00:41<11:52,  6.08it/s]train-0:   5%|▌         | 252/4584 [00:41<11:42,  6.17it/s]train-0:   6%|▌         | 253/4584 [00:41<11:29,  6.28it/s]train-0:   6%|▌         | 254/4584 [00:41<11:34,  6.23it/s]train-0:   6%|▌         | 255/4584 [00:41<11:19,  6.37it/s]train-0:   6%|▌         | 256/4584 [00:41<11:11,  6.44it/s]train-0:   6%|▌         | 257/4584 [00:42<11:05,  6.51it/s]train-0:   6%|▌         | 258/4584 [00:42<11:12,  6.43it/s]train-0:   6%|▌         | 259/4584 [00:42<11:22,  6.34it/s]train-0:   6%|▌         | 260/4584 [00:42<11:37,  6.20it/s]train-0:   6%|▌         | 261/4584 [00:42<11:47,  6.11it/s]train-0:   6%|▌         | 262/4584 [00:42<12:07,  5.94it/s]train-0:   6%|▌         | 263/4584 [00:43<11:38,  6.19it/s]train-0:   6%|▌         | 264/4584 [00:43<11:24,  6.32it/s]train-0:   6%|▌         | 265/4584 [00:43<11:32,  6.24it/s]train-0:   6%|▌         | 266/4584 [00:43<11:57,  6.02it/s]train-0:   6%|▌         | 267/4584 [00:43<11:55,  6.04it/s]train-0:   6%|▌         | 268/4584 [00:43<12:11,  5.90it/s]train-0:   6%|▌         | 269/4584 [00:44<11:34,  6.22it/s]train-0:   6%|▌         | 270/4584 [00:44<11:24,  6.30it/s]train-0:   6%|▌         | 271/4584 [00:44<11:15,  6.38it/s]train-0:   6%|▌         | 272/4584 [00:44<11:17,  6.36it/s]train-0:   6%|▌         | 273/4584 [00:44<11:14,  6.39it/s]train-0:   6%|▌         | 274/4584 [00:44<11:15,  6.38it/s]train-0:   6%|▌         | 275/4584 [00:45<11:32,  6.23it/s]train-0:   6%|▌         | 276/4584 [00:45<11:35,  6.19it/s]train-0:   6%|▌         | 277/4584 [00:45<11:40,  6.15it/s]train-0:   6%|▌         | 278/4584 [00:45<11:27,  6.27it/s]train-0:   6%|▌         | 279/4584 [00:45<11:29,  6.25it/s]train-0:   6%|▌         | 280/4584 [00:45<11:09,  6.42it/s]train-0:   6%|▌         | 281/4584 [00:46<11:26,  6.27it/s]train-0:   6%|▌         | 282/4584 [00:46<11:00,  6.51it/s]train-0:   6%|▌         | 283/4584 [00:46<11:11,  6.41it/s]train-0:   6%|▌         | 283/4584 [00:46<11:46,  6.09it/s]
Traceback (most recent call last):
  File "multitask_classifier.py", line 792, in <module>
    train_multitask(args)
  File "multitask_classifier.py", line 442, in train_multitask
    optimizer.step()
  File "/home/pomelo/Documents/Xingjian/cs224n_2/pcgrad.py", line 67, in step
    return self._optim.step()
  File "/home/pomelo/miniconda3/envs/cs224n_dfp/lib/python3.8/site-packages/torch/optim/optimizer.py", line 391, in wrapper
    out = func(*args, **kwargs)
  File "/home/pomelo/Documents/Xingjian/cs224n_2/optimizer.py", line 72, in step
    p.data = p.data - alpha * m_t_hat/(torch.sqrt(vm_t_hat) + eps) - alpha*weight_decay*p.data
KeyboardInterrupt
